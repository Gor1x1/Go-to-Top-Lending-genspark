# Go to Top — Админ-платформа PRD

## Проект
- **Go to Top** — сервис продвижения товаров на Wildberries через выкупы
- Сайт: https://gototop.win | Админка: https://gototop-wb.pages.dev/admin
- GitHub: https://github.com/Gor1x1/Go-to-Top-Lending-genspark

## Стек (Emergent Platform)
- Backend: FastAPI + MongoDB | Frontend: React 18 + Lucide Icons
- Auth: JWT + bcrypt | Дизайн: Dark UI, Manrope, фиолетовый (#8B5CF6)

## Реализовано

### Фаза 1 (2026-02-19): Система ролей
- JWT авторизация, 6 ролей, CRUD сотрудников, настройка доступов

### Фаза 1.5 (2026-02-19): Объединение с оригинальной админкой
- 14 разделов: Дашборд, Лиды/CRM, Конструктор блоков, Калькулятор, PDF шаблон, Реферальные коды, Счётчики слотов, Футер, TG сообщения, TG Бот, Скрипты, Сотрудники, Доступы, Настройки

### Фаза 2 (2026-02-19): Расширенный CRM Лидов
- Карточки лидов с #номерами, бейджами источников, суммами (֏)
- 4 источника: Форма, Калькулятор (с PDF), Telegram, Вручную
- Аналитика лидов: всего, общая стоимость, сегодня, по статусам, по источникам
- Редактирование, быстрая смена статуса, CSV экспорт

### Фаза 3 (2026-02-19): Интеграция калькулятора в Лиды + Конструктор блоков v2
- **Калькулятор в карточках лидов:**
  - Кнопка "Рассчитать стоимость" для лидов с форм (без расчёта)
  - Модальное окно с услугами из базы данных (вкладки калькулятора)
  - Выбор услуг с количеством (+/- контролы)
  - Динамический расчёт итоговой суммы
  - Генерация PDF-документа (ReportLab)
  - Автоматическое прикрепление PDF и данных расчёта к лиду
  - Кнопка "Пересчитать" для изменения расчёта
  - Скачивание PDF из карточки лида

- **Конструктор блоков v2:**
  - Парсинг блоков с живого сайта (BeautifulSoup)
  - Импорт 20+ блоков за раз с превью
  - Визуальное редактирование: заголовки, тексты (RU/AM), изображения, кнопки
  - Drag-and-drop для изменения порядка блоков
  - Загрузка изображений с компьютера (API /api/upload)
  - Дублирование блоков
  - Включение/отключение видимости
  - Типы блоков: section, hero, features, cta, custom
  - Поддержка Custom CSS/HTML

## Новые API эндпоинты (Фаза 3)
- `GET /api/calc-services-public` — публичный список услуг калькулятора
- `POST /api/generate-pdf` — генерация PDF с расчётом
- `GET /api/site-blocks` — список блоков
- `POST /api/site-blocks` — создание блока
- `POST /api/site-blocks/fetch-from-site` — парсинг блоков с сайта
- `POST /api/site-blocks/import` — массовый импорт блоков
- `PUT /api/site-blocks/{id}` — обновление блока
- `POST /api/site-blocks/reorder` — изменение порядка блоков
- `POST /api/site-blocks/duplicate/{id}` — дублирование блока
- `DELETE /api/site-blocks/{id}` — удаление блока
- `POST /api/upload` — загрузка изображений

## Тестирование
- Фаза 3: 100% Backend (11/11), 100% Frontend

## Бэклог
### P0: Нет
### P1: Общий аудит и исправление ошибок во всех разделах
### P2:
- Миграция данных из D1
- Система заказов
- Рабочий стол по ролям
- TG уведомления
- Финансовая отчётность

## Credentials
- **Login:** admin
- **Password:** gototop2026
